title: VOOL EV Charging
views:
  - title: Charger
    path: charger
    icon: mdi:ev-station
    type: sections
    sections:
      - type: grid
        cards:
          # Main Status Card
          - type: custom:mushroom-template-card
            primary: "{{ states('sensor.vool_charger_charger_state') }}"
            secondary: >-
              {% if is_state('binary_sensor.vool_charger_charging', 'on') %}
                Charging at {{ states('sensor.vool_charger_active_power') }} kW
              {% elif is_state('binary_sensor.vool_charger_connected', 'on') %}
                Vehicle connected
              {% else %}
                No vehicle connected
              {% endif %}
            icon: >-
              {% if is_state('binary_sensor.vool_charger_charging', 'on') %}
                mdi:battery-charging
              {% elif is_state('binary_sensor.vool_charger_connected', 'on') %}
                mdi:ev-plug-type2
              {% else %}
                mdi:ev-station
              {% endif %}
            icon_color: >-
              {% if is_state('binary_sensor.vool_charger_charging', 'on') %}
                green
              {% elif is_state('binary_sensor.vool_charger_connected', 'on') %}
                blue
              {% else %}
                grey
              {% endif %}
            badge_icon: >-
              {% if is_state('binary_sensor.vool_charger_error', 'on') %}
                mdi:alert-circle
              {% endif %}
            badge_color: red
            layout: vertical
            tap_action:
              action: more-info
            entity: sensor.vool_charger_charger_state
            card_mod:
              style: |
                ha-card {
                  --ha-card-border-radius: 16px;
                }
        columns: 1
        
      - type: grid
        cards:
          # Power Gauge
          - type: gauge
            entity: sensor.vool_charger_active_power
            name: Charging Power
            unit: kW
            min: 0
            max: 22
            severity:
              green: 0
              yellow: 11
              red: 18
            needle: true
            
          # Energy Imported
          - type: statistic
            entity: sensor.vool_charger_energy_imported
            name: Energy Imported
            stat_type: state
            
        columns: 2
        
      - type: grid
        cards:
          # Current per phase
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.vool_charger_current_l1
                name: L1
                color: '#f44336'
              - entity: sensor.vool_charger_current_l2
                name: L2
                color: '#4caf50'
              - entity: sensor.vool_charger_current_l3
                name: L3
                color: '#2196f3'
            name: Current per Phase
            hours_to_show: 1
            points_per_hour: 60
            line_width: 2
            show:
              labels: true
              points: false
            
          # Voltage per phase
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.vool_charger_voltage_l1
                name: L1
                color: '#f44336'
              - entity: sensor.vool_charger_voltage_l2
                name: L2
                color: '#4caf50'
              - entity: sensor.vool_charger_voltage_l3
                name: L3
                color: '#2196f3'
            name: Voltage per Phase
            hours_to_show: 1
            points_per_hour: 60
            line_width: 2
            show:
              labels: true
              points: false
              
        columns: 2

      - type: grid
        cards:
          # Controls Section Header
          - type: markdown
            content: "## Controls"
            
        columns: 1
        
      - type: grid
        cards:
          # Charging Enabled Switch
          - type: custom:mushroom-entity-card
            entity: switch.vool_charger_charging_enabled
            name: Charging Enabled
            icon_color: green
            tap_action:
              action: toggle
              
          # Start Charging Button
          - type: custom:mushroom-entity-card
            entity: button.vool_charger_start_charge
            name: Start
            icon: mdi:play
            icon_color: green
            tap_action:
              action: call-service
              service: button.press
              target:
                entity_id: button.vool_charger_start_charge
                
          # Stop Charging Button
          - type: custom:mushroom-entity-card
            entity: button.vool_charger_stop_charge
            name: Stop
            icon: mdi:stop
            icon_color: red
            tap_action:
              action: call-service
              service: button.press
              target:
                entity_id: button.vool_charger_stop_charge
                
        columns: 3

      - type: grid
        cards:
          # External Current Limit Slider
          - type: custom:mushroom-number-card
            entity: number.vool_charger_external_current_limit
            name: External Current Limit
            icon_color: blue
            display_mode: slider
            
          # Allowed Phases Select
          - type: custom:mushroom-select-card
            entity: select.vool_charger_allowed_phases
            name: Allowed Phases
            icon_color: purple
            
        columns: 2

      - type: grid
        cards:
          # Detailed Info
          - type: entities
            title: Detailed Information
            entities:
              - entity: sensor.vool_charger_charger_state
                name: State
              - entity: sensor.vool_charger_active_power
                name: Active Power
              - entity: sensor.vool_charger_energy_imported
                name: Energy Imported
              - entity: sensor.vool_charger_current_l1
                name: Current L1
              - entity: sensor.vool_charger_current_l2
                name: Current L2
              - entity: sensor.vool_charger_current_l3
                name: Current L3
              - entity: sensor.vool_charger_voltage_l1
                name: Voltage L1
              - entity: sensor.vool_charger_voltage_l2
                name: Voltage L2
              - entity: sensor.vool_charger_voltage_l3
                name: Voltage L3
              - entity: sensor.vool_charger_external_current_limit
                name: External Current Limit
              - entity: sensor.vool_charger_requested_phases
                name: Requested Phases
                
        columns: 1
